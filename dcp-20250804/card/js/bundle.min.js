document.addEventListener("DOMContentLoaded",()=>{const e=()=>document.querySelector(".js-media-popup").classList.remove("show"),t=e=>{const t=Math.floor(e/60),n=Math.floor(e%60);return`${t.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`},n=e=>{const t=document.querySelector(".js-media-scene.current");if(null!==t&&t.classList.remove("current"),null===e)return;document.querySelector('.js-media-scene[data-scene-id="'+e+'"]').classList.add("current")};document.querySelector(".js-media-cta").addEventListener("click",()=>{s.style.display="",c.currentTime=0,c.play(),n("1"),document.querySelector(".js-media-popup").classList.add("show")});const r=document.querySelector('.js-media-scene[data-scene-id="1"]'),s=r.querySelector(".js-skip"),d=r.querySelector(".js-return");s.addEventListener("click",()=>{c.currentTime=30}),d.addEventListener("click",()=>{c.pause(),n(null),e()});const c=r.querySelector(".js-main-video");c.addEventListener("timeupdate",()=>{const e=c.currentTime;if(e>30)return c.pause(),void n("2");s.style.display=e>=15?"inline-block":""});const o=r.querySelector(".js-play-or-pause"),i=r.querySelector(".js-current-time"),a=r.querySelector(".js-duration"),l=r.querySelector(".js-volume-slider"),u=r.querySelector(".js-progress-container"),m=r.querySelector(".js-progress-bar"),y=r.querySelector(".js-progress-handle");c.addEventListener("loadedmetadata",()=>{a.textContent=t(c.duration)}),o.addEventListener("click",()=>{c.paused?(c.play(),o.textContent="停止"):(c.pause(),o.textContent="再生")}),c.addEventListener("play",()=>{o.textContent="停止"}),c.addEventListener("pause",()=>{o.textContent="再生"}),c.addEventListener("timeupdate",()=>{const e=c.currentTime,n=c.duration;if(i.textContent=t(e),n>0){const t=e/n*100;m.style.width=t+"%",y.style.left=t+"%"}}),l.addEventListener("input",e=>{c.muted&&(c.muted=!1),c.volume=parseFloat(e.target.value)}),u.addEventListener("click",e=>{const t=u.getBoundingClientRect(),n=(e.clientX-t.left)/t.width,r=c.duration;r>0&&(c.currentTime=r*n)});let p=!1;y.addEventListener("mousedown",e=>{p=!0,e.preventDefault()}),document.addEventListener("mousemove",e=>{if(!p)return;const t=u.getBoundingClientRect(),n=Math.max(0,Math.min(e.clientX-t.left,t.width))/t.width,r=c.duration;r>0&&(m.style.width=100*n+"%",y.style.left=100*n+"%",c.currentTime=r*n)}),document.addEventListener("mouseup",()=>{p=!1}),c.addEventListener("error",e=>{console.error("エラー:",e)});const v=document.querySelector('.js-media-scene[data-scene-id="2"]'),S=v.querySelector(".js-replay");v.querySelectorAll(".js-option").forEach(e=>{e.addEventListener("click",()=>{L.src=e.dataset.videoUrl,L.currentTime=0,L.play(),n("3")})}),S.addEventListener("click",()=>{s.style.display="",c.currentTime=0,c.play(),n("1")});const L=document.querySelector('.js-media-scene[data-scene-id="3"]').querySelector(".js-option-video");L.addEventListener("ended",()=>{L.pause(),L.src="",L.currentTime=0,n("4")});const j=document.querySelector('.js-media-scene[data-scene-id="4"]'),q=j.querySelector(".js-finish"),E=j.querySelector(".js-again");q.addEventListener("click",()=>{n(null),e()}),E.addEventListener("click",()=>{n("2")})});
